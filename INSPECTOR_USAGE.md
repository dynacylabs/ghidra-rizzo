# Rizzo Inspector Usage Guide

The `rizzo_inspector.py` is a standalone Python script that can analyze Rizzo signature files outside of Ghidra. This is useful for understanding the contents of signature files, debugging signature generation, and exporting data for analysis.

## Features

- **Summary Statistics**: Overview of signature counts and metadata coverage
- **Detailed Function Information**: Complete metadata for each function
- **Function Search**: Find functions by name pattern
- **Metadata Filtering**: Show only functions with enhanced metadata
- **CSV Export**: Export function data for spreadsheet analysis
- **Cross-Platform**: Works with Python 3 outside of Ghidra

## Usage Examples

### 1. Basic Summary (Default)
```bash
python rizzo_inspector.py signatures.rizz
```

Shows:
- File information and size
- Signature type counts (formal, fuzzy, string, etc.)
- Duplicate signature counts
- Enhanced metadata analysis and coverage percentages

### 2. Detailed Function Information
```bash
python rizzo_inspector.py signatures.rizz --detailed
```

Shows complete information for each function including:
- Function signatures (return types, parameters, calling conventions)
- Variable information (parameters, local variables, high-level symbols)
- All comment types with breakdown

### 3. List All Functions
```bash
python rizzo_inspector.py signatures.rizz --functions
```

Shows basic information for all functions without detailed metadata.

### 4. Search for Specific Functions
```bash
python rizzo_inspector.py signatures.rizz --search malloc
python rizzo_inspector.py signatures.rizz --search "str"
```

Finds all functions whose names contain the search term (case-insensitive).

### 5. Show Only Functions with Enhanced Metadata
```bash
python rizzo_inspector.py signatures.rizz --metadata
```

Filters to show only functions that have enhanced metadata (signatures, variables, or comments).

### 6. Export to CSV
```bash
python rizzo_inspector.py signatures.rizz --export-csv functions.csv
```

Exports function data to a CSV file with columns for:
- function_name, address, blocks_count
- has_signature, return_type, calling_convention, param_count
- has_variables, local_vars_count
- has_comments, comment_types

## Output Interpretation

### Summary Statistics
- **Signature Counts**: Number of each signature type generated
- **Duplicate Counts**: Signatures that appeared in multiple functions (filtered out)
- **Enhanced Metadata**: Functions with additional data beyond basic signatures
- **Coverage Percentages**: What percentage of functions have each type of metadata

### Function Information
- **Address**: Memory address of the function in hex
- **Blocks**: Number of basic blocks in the function
- **Metadata Types**: Which enhanced features are available (signature, variables, comments)

### Enhanced Metadata Details
- **Signature Metadata**: Return types, parameter info, calling conventions
- **Variable Metadata**: Parameters, local variables, high-level decompiler symbols
- **Comment Metadata**: All comment types (function, plate, pre/post, EOL, repeatable)

## Understanding Enhanced vs Legacy Functions

**Enhanced Functions** (new format):
- Have signature information (return types, parameters)
- Include variable and symbol data
- Contain comprehensive comments
- Use robust data type resolution

**Legacy Functions** (original format):
- Only have function name and basic block signatures
- Limited to name matching functionality
- Compatible with original Rizzo

## Compatibility

The inspector handles both:
- **New enhanced signature files**: Generated by the improved Rizzo
- **Original Rizzo files**: Legacy signature files (with limited information)
- **Mixed files**: Files containing both enhanced and legacy function data

## Use Cases

1. **Debugging Signature Generation**: Verify what metadata was extracted
2. **Quality Assessment**: Check coverage of enhanced metadata
3. **Function Discovery**: Find functions with specific characteristics
4. **Data Export**: Export for analysis in spreadsheets or other tools
5. **Signature Comparison**: Compare different signature files
6. **Documentation**: Generate reports on function metadata

## Requirements

- Python 3.x
- Standard library modules only (pickle, csv, argparse, os, sys)
- No Ghidra dependency - runs standalone

## Tips

- Use `--detailed` for complete analysis of small signature files
- Use `--functions` for quick overview of large files
- Use `--metadata` to focus on functions with enhanced data
- Use `--export-csv` to analyze data in Excel or other spreadsheet tools
- Use `--search` to find specific functions of interest

## Example Workflow

1. Generate signatures in Ghidra using enhanced Rizzo
2. Use inspector to verify metadata was captured correctly
3. Search for specific functions to understand their signatures
4. Export to CSV for documentation or comparison purposes
5. Use summary statistics to assess signature file quality
